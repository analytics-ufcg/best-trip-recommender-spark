{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Analise de pernas de ônibus\"\nauthor: \"Luiz Alberto Fonseca\"\ndate: \"September 5, 2017\"\noutput: html_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\n```{r}\nlibrary(readr)\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(scales)\n\n```\n\n\n```{r}\ndados.bulma <- read_csv(\"~/Analytics/MBServer/analise/dadostratados.csv\")\n```\n\n```{r}\nggplot(dados.bulma, aes(x = as.factor(hourOrig), y = duration)) +\ngeom_jitter(aes(alpha = 0.5))\n\nggplot(dados.bulma, aes(x = as.factor(hourOrig), y = duration)) +\ngeom_boxplot()\n```\n\nAgrupando por data e calculando a media e mediana de cada hora.\n\n```{r}\ntemp1 <- dados.bulma %>% group_by(date, hourOrig) %>%\n  summarise(media = mean(duration),\n            mediana = median(duration))\n\nggplot(temp1, aes(x = as.factor(hourOrig), y = mediana, group = date, colour = as.factor(date))) +\n  geom_line() + geom_point()\n\nggplot(temp1, aes(x = as.factor(hourOrig), y = media, group = date, colour = as.factor(date))) +\n  geom_line() + geom_point()\n```\n\nCalculando a média e mediana para cada hora sem agrupar por data\n\n```{r}\ntemp2 <- dados.bulma %>% group_by(hourOrig) %>%\n  summarise(media = mean(duration),\n            mediana = median(duration))\n\nggplot(temp2, aes(x = as.factor(hourOrig), y = media, fill = as.factor(hourOrig))) +\n    geom_bar(width = 1, stat=\"identity\")\n\n```\n\nComparando a hora com as demais horas do dia\n(Para aquele dia, como se comporta aquela hora em comparação com as demais)\n\n```{r}\n# mediana por data\ntemp3 <- dados.bulma %>%\n  group_by(date) %>%\n  summarise(median_duration = median(duration))\n\n# mediana por data e hora\ntemp4 <- left_join(temp1, temp3, by = \"date\")\n\n# Quantos segundos a mediana da hora difere da mediana do dia\ntemp4 <- temp4 %>% mutate(\n  diff_medians = mediana - median_duration\n)\n\ntemp5 <- temp4 %>% group_by(hourOrig) %>%\n  summarise(media_diff_mediana = mean(diff_medians))\n\n# plot\nggplot(temp5, aes(as.factor(hourOrig), media_diff_mediana)) +\n  geom_bar(stat = \"identity\", fill = \"navyblue\", legend = FALSE) + \n  scale_y_continuous(\"Média da diferença entre a mediana das durações da hora \\n e mediana das durações do dia para cada dia (segundos)\") +\n  theme(axis.title.x = element_blank()) +\n  labs(x = \"hora do dia\")\n\n```\n\n",
    "created" : 1504632134813.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2278955258",
    "id" : "C7421378",
    "lastKnownWriteTime" : 1504641373,
    "last_content_update" : 1504641596054,
    "path" : "~/Analytics/MBServer/analise/analiseDeTrechos.Rmd",
    "project_path" : "analiseDeTrechos.Rmd",
    "properties" : {
        "last_setup_crc32" : "27292B1Ebb338d19",
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}