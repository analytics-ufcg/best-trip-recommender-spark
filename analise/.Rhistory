library(readr)
library(ggplot2)
library(tidyverse)
dados.bulma <- read_csv("~/Analytics/MBServer/analise/dadostratados.csv")
ggplot(dados.bulma, aes(x = as.factor(hourOrig), y = duration)) +
geom_jitter(aes(alpha = 0.5))
ggplot(dados.bulma, aes(x = as.factor(hourOrig), y = duration)) +
geom_boxplot()
temp1 <- dados.bulma %>% group_by(date, hourOrig) %>%
summarise(media = mean(duration),
mediana = median(duration))
View(temp1)
# mediana por data
temp3 <- dados.bulma %>%
group_by(date) %>%
summarise(median_duration = median(duration))
View(temp3)
temp3 <- dados.bulma %>%
group_by(date) %>%
summarise(median_date = median(duration))
temp4 <- left_join(temp1, temp3, by = "date")
View(temp4)
temp4 <- temp4 %>% mutate(
diff_medians = mediana - median_date
)
temp5 <- temp4 %>% group_by(hourOrig) %>%
summarise(media_diff_mediana = mean(diff_medians))
View(temp5)
ggplot(temp5, aes(as.factor(hourOrig), media_diff_mediana)) +
geom_bar(stat = "identity", aes(fill = hourOrig), legend = FALSE) +
scale_y_continuous("Anteil in Prozent", labels = percent_format()) +
theme(axis.title.x = element_blank())
ggplot(temp5, aes(as.factor(hourOrig), media_diff_mediana)) +
geom_bar(stat = "identity", aes(fill = hourOrig), legend = FALSE) +
scale_y_continuous("Anteil in Prozent") +
theme(axis.title.x = element_blank())
ggplot(temp5, aes(as.factor(hourOrig), media_diff_mediana)) +
geom_bar(stat = "identity", legend = FALSE) +
scale_y_continuous("Anteil in Prozent") +
theme(axis.title.x = element_blank())
ggplot(temp5, aes(as.factor(hourOrig), media_diff_mediana)) +
geom_bar(stat = "identity", fill = "#56cd66", legend = FALSE) +
scale_y_continuous("Anteil in Prozent") +
theme(axis.title.x = element_blank())
ggplot(temp5, aes(as.factor(hourOrig), media_diff_mediana)) +
geom_bar(stat = "identity", fill = "#2f4c56", legend = FALSE) +
scale_y_continuous("Anteil in Prozent") +
theme(axis.title.x = element_blank())
ggplot(temp5, aes(as.factor(hourOrig), media_diff_mediana)) +
geom_bar(stat = "identity", fill = "#2f4c56", legend = FALSE) +
scale_y_continuous("Média das diferenças (em segundos)") +
theme(axis.title.x = element_blank()) +
labs(title = "Quanto (em média) a mediana das durações de cada hora difere da mediana das durações do dia")
ggplot(temp5, aes(as.factor(hourOrig), media_diff_mediana)) +
geom_bar(stat = "identity", fill = "#2f4c56", legend = FALSE) +
scale_y_continuous("Média das diferenças (em segundos)") +
theme(axis.title.x = element_blank()) +
labs(title = "Quanto (em média) a mediana das durações de cada hora difere \n da mediana das durações do dia")
ggplot(temp5, aes(as.factor(hourOrig), media_diff_mediana)) +
geom_bar(stat = "identity", fill = "#2f4c56", legend = FALSE) +
scale_y_continuous("Média das diferenças (em segundos)") +
theme(axis.title.x = element_blank()) +
labs(title = "Quanto (em média) a mediana das durações de cada hora difere \nda mediana das durações do dia")
View(dados.bulma)
View(temp1)
summary.weeks <- dados.bulma %>% group_by(weekOfYear) %>%
summarise(medianWeek = median(duration))
View(summary.weeks)
View(dados.bulma)
summary.weekdays <- dados.bulma %>% group_by(weekOfYear, weekDay) %>%
summarise(medianWeekday = median(duration))
View(summary.weekdays)
summary.weekdays <- left_join(summary.weekdays, summary.weeks, by = "weekOfYear")
View(summary.weekdays)
summary.weekdays$diffWeekdayToWeek <- summary.weekdays$medianWeekday - summary.weekdays$medianWeek
ggplot(summary.weekdays, aes(as.factor(weekDay), diffWeekdayToWeek)) +
geom_bar(stat = "identity", fill = "#2f4c56", legend = FALSE) +
scale_y_continuous("Média das diferenças (em segundos)") +
theme(axis.title.x = element_blank()) +
labs(title = "Quanto (em média) a mediana das durações de cada hora difere \nda mediana das durações do dia")
ggplot(summary.weekdays, aes(as.factor(weekDay), diffWeekdayToWeek)) +
geom_bar(stat = "identity", fill = "#2f4c56", legend = FALSE) +
scale_y_continuous("Média das diferenças (em segundos)") +
theme(axis.title.x = element_blank()) +
labs(title = "Quanto (em média) a mediana das durações de cada dia da semana difere \nda mediana das durações da semana")
View(dados.bulma)
library(ggmap)
install.packages("ggmap")
library(ggmap)
summary(dados.bulma$velocityKmh)
knitr::opts_chunk$set(echo = TRUE)
library(plyr)
library(tidyverse)
library(ggplot2)
data_directory_path = "~/Analytics/MBServer/analise/testData"
filenames <- list.files(data_directory_path, pattern="*.csv", full.names=TRUE)
list_of_dataframes <- lapply(filenames, read.csv)
busData <- rbind.fill(list_of_dataframes)
p <- ggplot(busData, aes(x = as.factor(hourOrig), y = duration, colour = problem))
p + geom_jitter(aes(alpha = 0.5))
p <- ggplot(busData, aes(x = as.factor(hourOrig), y = duration, colour = problem))
p + geom_jitter(aes(alpha = 0.5))
temp <- busData %>% filter(distanceTraveledShapeDest > 0)
p <- ggplot(temp, aes(x = as.factor(hourOrig), y = duration, colour = problem))
p + geom_jitter(aes(alpha = 0.5))
temp2 <- temp %>% filter(abs(tripNumOrig - tripNumDest) == 0)
p <- ggplot(temp2, aes(x = as.factor(hourOrig), y = duration, colour = problem))
p + geom_jitter(aes(alpha = 0.5))
temp3 <- temp2 %>% filter(busStopIdOrig != busStopIdDest)
p <- ggplot(temp3, aes(x = as.factor(hourOrig), y = duration, colour = problem))
p + geom_jitter(aes(alpha = 0.5))
temp3 <- temp3 %>% mutate(velocityKmh = ((distance / duration) * 3.6))
p <- ggplot(temp3, aes(x = "velocidade", y = velocityKmh, colour = problem))
p + geom_jitter(aes(alpha = 0.5))
temp4 <- temp3 %>% filter(velocityKmh <= 90)
# Filtrando velocidades irreais (muito altas)
temp4 <- temp3 %>% filter(velocityKmh <= 90)
# filtrando viagens sem problemas
temp5 <- temp4 %>% filter(problem == "NO_PROBLEM")
p <- ggplot(temp5, aes(x = "velocidade", y = velocityKmh, colour = problem))
p + geom_jitter(aes(alpha = 0.5))
p + geom_boxplot()
p <- ggplot(temp5, aes(x = as.factor(hourOrig), y = duration, colour = problem))
p + geom_jitter(aes(alpha = 0.5))
ggplot(dados.bulma, aes(x = as.factor(hourOrig), y = duration)) +
geom_jitter(aes(alpha = 0.5))
temp1 <- dados.bulma %>% group_by(date, hourOrig) %>%
summarise(media = mean(duration),
mediana = median(duration))
View(temp1)
temp1 <- dados.bulma %>% group_by(date, hourOrig) %>%
summarise(media = mean(duration),
mediana = median(duration))
dados.bulma <- read_csv("~/Analytics/MBServer/analise/dadostratados.csv")
temp1 <- dados.bulma %>% group_by(date, hourOrig) %>%
summarise(media = mean(duration),
mediana = median(duration))
View(temp1)
library(readr)
library(ggplot2)
library(tidyverse)
temp1 <- dados.bulma %>% group_by(date, hourOrig) %>%
summarise(media = mean(duration),
mediana = median(duration))
View(dados.bulma)
temp1 <- dados.bulma %>% group_by(date) %>%
summarise(media = mean(duration),
mediana = median(duration))
View(temp1)
knitr::opts_chunk$set(echo = TRUE)
m <- get_map("Curitiba",zoom=11,maptype="roadmap",source="google")
library(ggmap)
m <- get_map("Curitiba",zoom=11,maptype="roadmap",source="google")
m <- get_map("Curitiba",zoom=11,maptype="toner",source="stamen")
g <- ggmap(m)
g
df <- read.csv("/local/orion/bigsea/BULMA/BULMA_7months/2017_07_03_veiculos.csv/part-00000")
library(readr)
df <- read_csv("/local/orion/bigsea/BULMA/BULMA_7months/2017_07_03_veiculos.csv/part-00000")
View(df)
max(df$-_`-_2`)
?read_csv
df <- read_csv("/local/orion/bigsea/BULMA/BULMA_7months/2017_07_03_veiculos.csv/part-00000", col_names = F)
max(df$X16)
ggplot(df, aes(x = "passengers", y = X16)) + geom_boxplot()
ggplot(df, aes(X16)) + geom_boxplot()
ggplot(df, aes(X16, "passengers")) + geom_boxplot()
ggplot(df, aes("passengers", X16)) + geom_boxplot()
ggplot(df, aes(X15, X16)) + geom_boxplot()
df <- read_csv("/local/orion/bigsea/BULMA/BULMA_7months/2017_07_03_veiculos.csv/part-00000", col_names = F, na = c("-"))
ggplot(df, aes(X15, X16)) + geom_boxplot()
df2 <- read_csv("/local/orion/bigsea/BULMA/BULMA_7months/2017_07_01_veiculos.csv/part-00000", col_names = F, na = c("-"))
ggplot(df2, aes(X15, X16)) + geom_boxplot()
summary(df2$X16)
df <- NULL
df2 <- NULL
read_csv("/local/orion/bigsea/BULMA/BULMA_7months/2017_07_10_veiculos.csv/part-00000", col_names = F, na = c("-")) %>% ggplot(aes(X15, X16)) + geom_boxplot()
library(dplyr)
read_csv("/local/orion/bigsea/BULMA/BULMA_7months/2017_07_10_veiculos.csv/part-00000", col_names = F, na = c("-")) %>% ggplot(aes(X15, X16)) + geom_boxplot()
read_csv("/local/orion/bigsea/BULMA/BULMA_7months/2017_07_24_veiculos.csv/part-00000", col_names = F, na = c("-")) %>% ggplot(aes(X15, X16)) + geom_boxplot()
read_csv("/local/orion/bigsea/BULMA/BULMA_7months/2017_07_17_veiculos.csv/part-00000", col_names = F, na = c("-")) %>% ggplot(aes(X15, X16)) + geom_boxplot()
read_csv("/local/orion/bigsea/BULMA/BULMA_7months/2017_07_17_veiculos.csv/part-00000", col_names = F, na = c("-")) %>%  filter(X16 > 0) %>% ggplot(aes(X15, X16)) + geom_boxplot()
read_csv("/local/orion/bigsea/BULMA/BULMA_7months/2017_07_01_veiculos.csv/part-00000", col_names = F, na = c("-")) %>%  filter(X16 > 0) %>% ggplot(aes(X15, X16)) + geom_boxplot()
read_csv("/local/orion/bigsea/BULMA/BULMA_7months/2017_07_10_veiculos.csv/part-00000", col_names = F, na = c("-")) %>%  filter(X16 > 0) %>% summary()
read_csv("/local/orion/bigsea/BULMA/BULMA_7months/2017_07_03_veiculos.csv/part-00000", col_names = F, na = c("-")) %>%  filter(X16 > 0) %>% summary()
